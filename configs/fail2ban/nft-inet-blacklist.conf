[Definition]
actionstart =
actionstop =
actioncheck =

# 智能检测IP类型并添加到对应的集合
actionban = ip="<ip>"
            if echo "$ip" | grep -q ":"; then
                nft add element inet filter ip_blacklist_v6 { $ip }
            else
                nft add element inet filter ip_blacklist_v4 { $ip }
            fi

actionunban = ip="<ip>"
              if echo "$ip" | grep -q ":"; then
                  nft delete element inet filter ip_blacklist_v6 { $ip }
              else
                  nft delete element inet filter ip_blacklist_v4 { $ip }
              fi

[Init]
init = nft list set inet filter ip_blacklist_v4 >/dev/null 2>&1 && nft list set inet filter ip_blacklist_v6 >/dev/null 2>&1 || exit 0

# 协议和端口配置（Fail2Ban 需要）
protocol = all
name = nft-inet-blacklist
port = 0